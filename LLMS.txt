# Umara

> Beautiful Python UI framework for building web applications without HTML, CSS, or JavaScript.

## Overview

Umara is a Python framework that lets you create modern web UIs with pure Python code. It's similar to Streamlit but with better styling, themes, and more layout control.

## Installation

```bash
pip install umara
```

## Quick Start

```python
import umara as um

um.set_theme('ocean')  # 12 built-in themes available
um.header('My App')

# Use form for input + button patterns (ensures value is captured)
with um.form('greeting_form'):
    name = um.input('Your name', key='user_name')

    if um.form_submit_button('Greet'):
        um.success(f'Hello, {name}!')
```

Run with: `umara run app.py`
Open: http://localhost:8501

## Core Patterns

### Display Text
```python
um.title('Page Title')
um.header('Section')
um.subheader('Subsection')
um.text('Regular text')
um.markdown('**bold** and *italic*')
um.code('print("hello")', language='python')
```

### Get User Input
```python
# IMPORTANT: Always use key= for standalone inputs to persist values across reruns
text = um.input('Label', placeholder='hint', key='my_text')
text_long = um.text_area('Bio', rows=4, key='my_bio')
num = um.number_input('Age', min_value=0, max_value=120, key='my_num')
num2 = um.slider('Value', 0, 100, 50, key='my_slider')
choice = um.select('Pick', ['A', 'B', 'C'], key='my_select')
choices = um.multiselect('Tags', ['Red', 'Green', 'Blue'], key='my_multi')
option = um.radio('Size', ['S', 'M', 'L'], key='my_radio')
checked = um.checkbox('Agree', key='my_checkbox')
enabled = um.toggle('Feature', key='my_toggle')
date = um.date_input('Date', key='my_date')
time = um.time_input('Time', key='my_time')
color = um.color_picker('Color', value='#6366f1', key='my_color')
rating = um.rating('Rate', value=3, max_value=5, key='my_rating')
file = um.file_uploader('Upload', accept=['.csv'], max_file_size=5*1024*1024, key='my_file')
```

### Buttons
```python
if um.button('Click', variant='primary'):  # primary, secondary, outline, ghost, danger
    um.success('Clicked!')

um.button('Loading...', loading=True)  # Show spinner

# Download button
um.download_button('Download CSV', csv_data, file_name='data.csv')
```

### Layouts
```python
# Columns
with um.columns(3):
    with um.column():
        um.text('Col 1')
    with um.column():
        um.text('Col 2')
    with um.column():
        um.text('Col 3')

# Cards
with um.card(title='Title'):
    um.text('Content')

# Tabs
with um.tabs(['Tab 1', 'Tab 2']) as t:
    with t.tab(0):
        um.text('Content 1')
    with t.tab(1):
        um.text('Content 2')

# Grid
with um.grid(columns=4, gap='16px'):
    for i in range(8):
        um.text(f'Item {i}')

# Sidebar
with um.sidebar():
    um.header('Navigation')
    um.text('Sidebar content')

# Expander (collapsible)
with um.expander('Click to expand'):
    um.text('Hidden content')

# Modal dialog
if um.button('Open Modal'):
    um.open_modal('my_modal')

with um.modal('Dialog Title', key='my_modal'):
    um.text('Modal content')
    if um.button('Close'):
        um.close_modal('my_modal')
```

### Data Display
```python
um.metric('Users', '12,543', delta=12.5)  # With trend indicator
um.progress(75, label='Completion')
um.dataframe(data, sortable=True)  # Works with pandas DataFrames
um.json_viewer({'key': 'value'})
um.badge('New', variant='success')  # success, warning, error, info
um.avatar(name='John Doe')  # Shows initials "JD"
um.avatar(src='https://example.com/avatar.jpg', size='lg')  # sm, md, lg, xl
um.divider()  # Horizontal line
um.spacer('24px')  # Vertical space
um.caption('Figure 1: Sample data')  # Small caption text
um.latex(r'E = mc^2')  # LaTeX math
```

### Navigation
```python
um.breadcrumbs([
    {'label': 'Home', 'href': '/'},
    {'label': 'Products', 'href': '/products'},
    {'label': 'Detail', 'href': '#'}
])

step = um.steps(['Cart', 'Shipping', 'Payment', 'Confirm'], current=1)
page = um.pagination(total_pages=10, current_page=1, key='page')
```

### Feedback
```python
um.success('Done!')
um.error('Failed')
um.warning('Caution')
um.info('Note')
um.toast('Quick notification', type='success', duration=3000)

# Loading spinner (context manager)
with um.spinner('Processing...'):
    result = slow_function()

# Exception display
try:
    risky_operation()
except Exception as e:
    um.exception(e)

# Force app rerun
um.rerun()
```

### Media
```python
um.image('https://example.com/img.png', caption='Photo')
um.video('video.mp4')
um.audio('audio.mp3')
```

### State Management
```python
# Persist data across reruns
um.session_state.setdefault('counter', 0)
um.session_state.counter += 1
```

### Keys vs Forms

**Standalone inputs (with key)** - Use for real-time updates (filtering, search):
```python
# Value updates on every keystroke (50ms debounce)
search = um.input('Search', key='search_query')
# Filter results in real-time
results = [item for item in items if search.lower() in item.lower()]
```

**Forms** - Use for input + button patterns (RECOMMENDED):
```python
# IMPORTANT: Use forms when you have inputs + a submit button
# Forms batch values and submit together, avoiding race conditions
with um.form('my_form'):
    name = um.input('Name', key='name')
    email = um.input('Email', key='email')
    if um.form_submit_button('Submit'):
        # Both values guaranteed to be current
        um.success(f'Submitted: {name}, {email}')
```

**When to use which:**
- Forms: input + button (reliable value capture)
- Standalone with key: real-time search/filter, toggles, checkboxes

**Why forms for input + button?** Standalone inputs have 50ms debounce. If user clicks button immediately after typing, value may not be synced. Forms guarantee all values are captured.

### Themes
```python
# 12 built-in themes
um.set_theme('light')   # default
um.set_theme('dark')    # dark mode
um.set_theme('ocean')   # blues
um.set_theme('forest')  # greens
# Also: slate, nord, midnight, rose, copper, lavender, sunset, mint

# Themes auto-persist to localStorage and respect system dark/light mode

# Custom theme
my_theme = um.create_theme('my_theme', base='light',
    colors={'primary': '#ff6b6b', 'secondary': '#4ecdc4'})
um.set_theme(my_theme)
```

### Page Configuration
```python
um.set_page_config(
    page_title='My App',
    page_icon='ðŸ“Š',  # Emoji or URL
    layout='wide',   # 'centered' or 'wide'
    initial_sidebar_state='auto'  # 'auto', 'expanded', 'collapsed'
)
```

### Custom Styling
```python
# Apply custom styles to any component
my_style = um.style(
    color='#ff0000',
    fontSize='18px',
    fontWeight='bold',
    padding='16px',
    backgroundColor='#f0f0f0',
    borderRadius='8px'
)
um.text('Styled text', style=my_style)
um.card(style=um.style(boxShadow='0 4px 6px rgba(0,0,0,0.1)'))
```

### Chat Interface
```python
um.session_state.setdefault('messages', [])

with um.chat_container(height='400px'):
    for msg in um.session_state.messages:
        um.chat_message(msg['content'], role=msg['role'])

user_input = um.chat_input('Type message...')
if user_input:
    um.session_state.messages.append({'role': 'user', 'content': user_input})
```

### Charts
```python
data = [{'month': 'Jan', 'value': 100}, {'month': 'Feb', 'value': 200}]
um.line_chart(data, x='month', y='value')
um.bar_chart(data, x='month', y='value')
um.area_chart(data, x='month', y='value')
um.pie_chart(data, label='month', value='value')
um.scatter_chart(data, x='month', y='value')

# Plotly charts (full Plotly.js support)
import plotly.express as px
fig = px.scatter(df, x='x', y='y', color='category')
um.plotly_chart(fig)
```

### Caching
```python
@um.cache_data  # Cache function results
def load_data():
    return pd.read_csv('large.csv')

@um.cache_resource  # Cache connections/models
def get_db():
    return sqlite3.connect('app.db')
```

### Fragments (Partial Reruns)
```python
# Only this section reruns when its inputs change
@um.fragment
def chart_section():
    points = um.slider('Points', 10, 100, 50, key='points')
    um.line_chart(generate_data(points))

# Auto-refresh every 5 seconds
@um.fragment(run_every=5)
def live_metrics():
    data = fetch_live_data()
    um.metric('Active Users', data['users'])

# Use in app
chart_section()
live_metrics()
```

### Connections (Database & API)
```python
# SQL database
conn = um.connection.sql('mydb', url='sqlite:///data.db')
users = conn.query('SELECT * FROM users WHERE age > ?', params=(18,))
conn.execute('INSERT INTO users (name) VALUES (?)', params=('Alice',))

# HTTP/REST API
api = um.connection.http('github', base_url='https://api.github.com',
                          headers={'Authorization': f'token {token}'})
repos = api.get('/users/octocat/repos')
api.post('/endpoint', json={'key': 'value'})
```

## Key Features

- **100+ Components**: Inputs, layouts, charts, data display, chat, navigation
- **12 Themes**: Light, dark, ocean, forest, slate, nord, midnight, rose, copper, lavender, sunset, mint
- **WebSocket-based**: Real-time updates without page refresh
- **Hot Reload**: Changes reflected instantly during development
- **State Management**: session_state persists data across reruns
- **Pandas Support**: DataFrames render as interactive tables
- **Accessibility**: ARIA labels on all interactive components
- **Theme Persistence**: Saves to localStorage, respects system dark mode

## File Structure

```
import umara as um

# 1. Configure page (optional)
um.set_page_config(page_title='My App', layout='wide')

# 2. Set theme (optional)
um.set_theme('ocean')

# 3. Build UI with components
um.header('My App')
# ... more components
```

## CLI Commands

```bash
umara run app.py              # Run app
umara run app.py --port 8080  # Custom port
umara init my_project         # Create new project
umara themes                  # List themes
```

## Common Patterns

### Dashboard
```python
with um.columns(4):
    for label, val, delta in [('Users', '1K', 5), ('Rev', '$10K', -2)]:
        with um.column():
            um.metric(label, val, delta=delta)
```

### Form Validation
```python
with um.form('contact'):
    name = um.input('Name', key='name')
    if um.form_submit_button('Submit'):
        if not name:
            um.error('Name required')
        else:
            um.success('Submitted!')
```

### File Upload
```python
file = um.file_uploader('Upload', accept=['.csv'], max_file_size=10*1024*1024)
if file:
    um.success(f'Got: {file["name"]} ({file["size"]} bytes)')
```

## Documentation

Full API reference: docs/UMARA_COMPLETE_REFERENCE.md
GitHub: https://github.com/lhassa8/umara
PyPI: https://pypi.org/project/umara/
